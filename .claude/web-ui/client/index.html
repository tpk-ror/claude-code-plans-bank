<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Claude Code Plans</title>

  <!-- xterm.js from CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.css">

  <!-- Custom styles -->
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/terminal.css">
</head>
<body class="dark-mode">
  <div id="app">
    <!-- Header -->
    <header class="header">
      <div class="header-left">
        <h1 class="logo">Claude Code Plans</h1>
      </div>
      <div class="header-center">
        <span class="sync-status" id="syncStatus">
          <span class="status-dot connected"></span>
          <span class="status-text">Connected</span>
        </span>
      </div>
      <div class="header-right">
        <button class="btn btn-primary" id="newPlanBtn">
          <span class="btn-icon">+</span> New Plan
        </button>
        <button class="btn btn-icon-only" id="themeToggle" title="Toggle theme">
          <span class="theme-icon">☀</span>
        </button>
      </div>
    </header>

    <!-- Main content area -->
    <div class="main-container">
      <!-- Sidebar with plans list -->
      <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
          <h2>Plans</h2>
          <button class="btn btn-sm btn-ghost" id="sidebarToggle" title="Toggle sidebar">
            ◀
          </button>
        </div>

        <!-- Filters -->
        <div class="filters">
          <select id="statusFilter" class="filter-select">
            <option value="">All Statuses</option>
            <option value="pending">Pending</option>
            <option value="in-progress">In Progress</option>
            <option value="completed">Completed</option>
          </select>
          <select id="categoryFilter" class="filter-select">
            <option value="">All Categories</option>
            <option value="feature">Feature</option>
            <option value="bugfix">Bugfix</option>
            <option value="refactor">Refactor</option>
            <option value="docs">Docs</option>
            <option value="test">Test</option>
            <option value="chore">Chore</option>
          </select>
          <input type="search" id="searchFilter" class="filter-input" placeholder="Search plans...">
        </div>

        <!-- Plans list -->
        <div class="plans-list" id="plansList">
          <div class="plans-loading">Loading plans...</div>
        </div>
      </aside>

      <!-- Main content: Terminal + Plan detail -->
      <main class="main-content">
        <!-- Terminal area -->
        <div class="terminal-container" id="terminalContainer">
          <div class="terminal-header">
            <span class="terminal-title">Terminal</span>
            <div class="terminal-actions">
              <button class="btn btn-sm btn-ghost" id="newSessionBtn" title="New session">
                + New
              </button>
              <button class="btn btn-sm btn-ghost" id="killSessionBtn" title="End session" disabled>
                ✕ End
              </button>
            </div>
          </div>
          <div class="terminal-wrapper" id="terminalWrapper">
            <div id="terminal"></div>
            <div class="terminal-placeholder" id="terminalPlaceholder">
              <p>No active session</p>
              <button class="btn btn-primary" id="startSessionBtn">Start Claude Session</button>
            </div>
          </div>
        </div>

        <!-- Plan detail panel (collapsible) -->
        <div class="plan-detail-panel collapsed" id="planDetailPanel">
          <div class="panel-header">
            <h3 class="panel-title" id="planDetailTitle">Select a plan</h3>
            <button class="btn btn-sm btn-ghost" id="closePanelBtn">✕</button>
          </div>
          <div class="panel-content" id="planDetailContent">
            <p class="empty-state">Select a plan from the sidebar to view details</p>
          </div>
        </div>
      </main>
    </div>

    <!-- New Plan Modal -->
    <div class="modal hidden" id="newPlanModal">
      <div class="modal-backdrop"></div>
      <div class="modal-content">
        <div class="modal-header">
          <h3>Create New Plan</h3>
          <button class="btn btn-sm btn-ghost modal-close" id="closeNewPlanModal">✕</button>
        </div>
        <form id="newPlanForm" class="modal-body">
          <div class="form-group">
            <label for="planTitle">Title</label>
            <input type="text" id="planTitle" required placeholder="e.g., Add user authentication">
          </div>
          <div class="form-group">
            <label for="planCategory">Category</label>
            <select id="planCategory">
              <option value="feature">Feature</option>
              <option value="bugfix">Bugfix</option>
              <option value="refactor">Refactor</option>
              <option value="docs">Documentation</option>
              <option value="test">Test</option>
              <option value="chore">Chore</option>
            </select>
          </div>
          <div class="form-group">
            <label for="planDescription">Description (optional)</label>
            <textarea id="planDescription" rows="3" placeholder="Brief description of the plan"></textarea>
          </div>
          <div class="form-group">
            <label for="planPriority">Priority</label>
            <select id="planPriority">
              <option value="low">Low</option>
              <option value="medium" selected>Medium</option>
              <option value="high">High</option>
            </select>
          </div>
          <div class="form-actions">
            <button type="button" class="btn btn-ghost" id="cancelNewPlan">Cancel</button>
            <button type="submit" class="btn btn-primary">Create Plan</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Add Note Modal -->
    <div class="modal hidden" id="addNoteModal">
      <div class="modal-backdrop"></div>
      <div class="modal-content modal-sm">
        <div class="modal-header">
          <h3>Add Note</h3>
          <button class="btn btn-sm btn-ghost modal-close" id="closeAddNoteModal">✕</button>
        </div>
        <form id="addNoteForm" class="modal-body">
          <div class="form-group">
            <label for="noteContent">Note</label>
            <textarea id="noteContent" rows="4" required placeholder="Enter your note..."></textarea>
          </div>
          <input type="hidden" id="noteFilename">
          <div class="form-actions">
            <button type="button" class="btn btn-ghost" id="cancelAddNote">Cancel</button>
            <button type="submit" class="btn btn-primary">Add Note</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Keyboard Shortcuts Help -->
    <div class="keyboard-help hidden" id="keyboardHelp">
      <h4>Keyboard Shortcuts</h4>
      <ul>
        <li><kbd>Ctrl</kbd>+<kbd>N</kbd> New Plan</li>
        <li><kbd>Escape</kbd> Focus Terminal</li>
        <li><kbd>Ctrl</kbd>+<kbd>B</kbd> Toggle Sidebar</li>
        <li><kbd>?</kbd> Show Help</li>
      </ul>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xterm-addon-fit@0.8.0/lib/xterm-addon-fit.min.js"></script>
  <script src="js/websocket.js"></script>
  <script src="js/terminal.js"></script>
  <script src="js/plans.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
